[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About me",
    "section": "",
    "text": "Following my Ph.D. defense at Lomonosov Moscow State University in December 2019, I received a Junior Research Fellow position in the Laboratory of Fluvial Processes and Soil Erosion at Faculty of Geography.\nBelow is my brief bio, while a full  can be downloaded here .\n\nResearch Interests\n\nMountain fluvial geomorphology\nSediment budget and dynamics\nSoil erosion modeling\nStatistical analyses on heterogeneous datasets and quantifying uncertainties based on Monte Carlo simulation techniques\nDesigning and maintaining large databases of measurements on various geomorphic processes\nQuantifying and understanding geomorphic processes at catchment and regional scale\n\n\n\nEducation\n\n\nLomonosov Moscow State University\nPhD in Geographic Sciences (Hydrology)\nAdvisors: Valentin Golosov, Sergey Chalov\n\n\nMoscow, Russia\nGranted Dec 2019\n\n\n\nDissertation: Suspended sediment load formation in small mountain river basins: general patterns and regional features\n\n\n\nLomonosov Moscow State University\nSpecialist in Hydrology (MSc. equivalent)\n\n\nMoscow, Russia\nGranted June 2015\n\n\n\n\nExperience\n\n\nInstitute of Geography Russian Academy of Science\n\n\nApril 2020 - present\n\n\nPostdoctoral Researcher\n\nWorking for the RSF grant No. 19‑17‑00181 “Quantitative assessment of the slope sediment flux and its changes in the Holocene for the Caucasus mountain rivers”\nSediment source fingerprinting analysis in small mountain basins\nSuspended sediment modelling on a regional scale (Caucasus)\nStudying short‑term and long water discharge and suspended sediment dynamics\nDeveloped an R package for exploring intra‑event suspended sediment dynamics loadflux\n\n\n\nLomonosov Moscow State University\n\n\nJanuary 2020 - present\n\n\nJunior Research Fellow\n\nOrganized two international conferences and two schools for young researchers\nEstimated soil erosion for the Eastern Russia (Siberia, Kamcharka, Chukotka)\nDeveloped algorithm to process short‑term logger data (turbidity and water level)\nDeveloped framework for assessing lateral erosion rates (and volumes) for Arctic rivers\n\n\n\nState Institute of Oceanography (Russia, Moscow)\n\n\nAugust 2015 - August 2017\n\n\nTechnician\n\nConducting hydrological measurements: water discharge, water stage, river velocity, river and lake bathymetry\nEquipment service: ADCPs, sonars, current meters\nStatistical analysis of main hydrological parameters (AEP, max and min discharges, etc.)\nFlood risk mapping for the Moscow city"
  },
  {
    "objectID": "data/!publ_list.html",
    "href": "data/!publ_list.html",
    "title": "Anatoly Tsyplenkov",
    "section": "",
    "text": "Author: Anatoly Tsyplenkov, Created: Aug 2022\n\n\nBelyakova, P., Moreydo, V., Tsyplenkov, A., Amerbaev, A., Grechishnikova, D., Kurochkina, L., Filippov, V., Makeev, M.. 2022. Forecasting Water Levels in Krasnodar Krai Rivers with the Use of Machine Learning. Water Resources 49: 10–22. DOI: 10.1134/S0097807822010043\n\n\nGolosov, V. N., Ivanov, M. M., Tsyplenkov, A. S., Ivanov, M. A., Konoplev, A. V., Wakiyama, Yu, Konstantinov, E. A., Ivanova, N. N.. 2021. Erosion as a Factor of Transformation of Soil Radioactive Contamination in the Basin of the Shchekino Reservoir (Tula Region). Eurasian Soil Science 54: 291–303. DOI: 10.1134/S106422932102006X\n\n\nGolosov, Valentin, Tsyplenkov, Anatoly. 2021. Factors Controlling Contemporary Suspended Sediment Yield in the Caucasus Region. Water 13: 3173. DOI: 10.3390/w13223173\n\n\nIvanov, M. M., Konoplev, A. V., Walling, D. E., Konstantinov, E. A., Gurinov, A. L., Ivanova, N. N., Kuzmenkova, N. V., Tsyplenkov, A. S., Ivanov, M. A., Golosov, V. N.. 2021. Using Reservoir Sediment Deposits to Determine the Longer-Term Fate of Chernobyl-Derived 137Cs Fallout in the Fluvial System. Environmental Pollution 274: 116588. DOI: 10.1016/j.envpol.2021.116588\n\n\nKuksina, L. V., Golosov, V.N., Zhdanova, E. Yu., Tsyplenkov, A. S.. 2021. Hydrological and Climatological Factors of Extreme Erosion Events in the Crimean Mountains. Vestnik Moskovskogo universiteta. Seriya 5, Geografiya NA: 36–50.\n\n\nTsyplenkov, Anatoly, Vanmaercke, Matthias, Collins, Adrian L., Kharchenko, Sergey, Golosov, Valentin. 2021. Elucidating Suspended Sediment Dynamics in a Glacierized Catchment after an Exceptional Erosion Event: The Djankuat Catchment, Caucasus Mountains, Russia. CATENA 203: 105285. DOI: 10.1016/j.catena.2021.105285\n\n\nTsyplenkov, A. S., Golosov, V. N., Belyakova, P. A.. 2021. How Did the Suspended Sediment Load Change in the North Caucasus during the Anthropocene?. Hydrological Processes 35: 1–20. DOI: 10.1002/hyp.14403\n\n\nTsyplenkov, Anatoly S., Ivanova, Nadezhda N., Botavin, Dmitry V., Kuznetsova, Yulia S., Golosov, Valentin N.. 2021. Hydro-Meteorological Preconditions and Geomorphological Consequences of Extreme Flood in the Small River Basin in the Wet Subtropical Zone (the Tsanyk River Case Study, Sochi Region). Vestnik of Saint Petersburg University. Earth Sciences 66: NA. DOI: 10.21638/spbu07.2021.109\n\n\nChalov, S. R., Tsyplenkov, A. S.. 2020. Influence of macroturbulence on the dynamics of river water turbidity. Vestnik Moskovskogo universiteta. Seriya 5, Geografiya 0: 34–46.\n\n\nKharchenko, Sergey, Tsyplenkov, Anatoly, Petrakov, Dmitry, Golosov, Valentin. 2020. Causes and Consequences of the Streambed Restructuring of the Koiavgan Creek (North Caucasus, Russia). E3S Web of Conferences 163: 02003. DOI: 10.1051/e3sconf/202016302003\n\n\nTsyplenkov, Anatoly, Vanmaercke, Matthias, Golosov, Valentin, Chalov, Sergey. 2020. Suspended Sediment Budget and Intra-Event Sediment Dynamics of a Small Glaciated Mountainous Catchment in the Northern Caucasus. Journal of Soils and Sediments 20: 3266–3281. DOI: 10.1007/s11368-020-02633-z\n\n\nKuznetsova, Yulia, Golosov, Valentin, Tsyplenkov, Anatoly, Ivanova, Nadezhda. 2019. Quantifying Channel Bank Erosion of a Small Mountain River in Russian Wet Subtropics Using Erosion Pins. Proceedings of the International Association of Hydrological Sciences 381: 79–86. DOI: 10.5194/piahs-381-79-2019\n\n\nRets, Ekaterina P., Popovnin, Viktor V., Toropov, Pavel A., Smirnov, Andrew M., Tokarev, Igor V., Chizhova, Julia N., Budantseva, Nadine A., Vasil’chuk, Yurij K., Kireeva, Maria B., Ekaykin, Alexey A., Veres, Arina N., Aleynikov, Alexander A., Frolova, Natalia L., Tsyplenkov, Anatoly S., Poliukhov, Aleksei A., Chalov, Sergey R., Aleshina, Maria A., Kornilova, Ekaterina D.. 2019. Djankuat Glacier Station in the North Caucasus, Russia: A Database of Glaciological, Hydrological, and Meteorological Observations and Stable Isotope Sampling Results during 2007–2017. Earth System Science Data 11: 1463–1481. DOI: 10.5194/essd-11-1463-2019\n\n\nTsyplenkov, Anatoly, Vanmaercke, Matthias, Golosov, Valentin. 2019. Contemporary Suspended Sediment Yield of Caucasus Mountains. Proceedings of the International Association of Hydrological Sciences 381: 87–93. DOI: 10.5194/piahs-381-87-2019\n\n\nChalov, S. R., Tsyplenkov, A. S.. 2017. Sediment Discharge of Small Rivers in Areas of Active Volcanism (River Sukhaya Elizovskaya, Kamchatka). Geomorphology RAS NA: 104–116. DOI: 10.15356/0435-4281-2017-1-104-116\n\n\nChalov, Sergey R., Tsyplenkov, Anatolii S., Pietron, Jan, Chalova, Aleksandra S., Shkolnyi, Danila I., Jarsjö, Jerker, Maerker, Michael. 2017. Sediment Transport in Headwaters of a Volcanic Catchment—Kamchatka Peninsula Case Study. Frontiers of Earth Science 11: 565–578. DOI: 10.1007/s11707-016-0632-x\n\n\nChalov, S., Golosov, V., Tsyplenkov, A., Theuring, Ph., Zakerinejad, R., Märker, M., Samokhin, M.. 2017. A Toolbox for Sediment Budget Research in Small Catchments. GEOGRAPHY, ENVIRONMENT, SUSTAINABILITY 10: 43–68. DOI: 10.24057/2071-9388-2017-10-4-43-68\n\n\nTsyplenkov, A. S., Golosov, V. N., Kuksina, L. V.. 2017. Assessment of Basin Component of Suspended Sediment Yield Generated Due to Rainfall Events at Small Rivers in Wet and Dry Subtropics. Engineering survey NA: 54–65. DOI: 10.25296/1997-8650-2017-9-54-65"
  },
  {
    "objectID": "index-old.html",
    "href": "index-old.html",
    "title": "Anatoly Tsyplenkov",
    "section": "",
    "text": "I did my Ph.D. at the Lomonosov Moscow State University, where I was interested in the spatio-temporal variability of sediment transport in mountain areas, and a postdoc at the Institute of Geography Russian Academy of Science, where I focused on remote sensing and geomorphology in the Caucasus. While a hydrologist and fluvial geomorphologist at the core, I am fascinated by creative ways to visualize the data (what dataviz designers do), and by transformative technologies to extract and disseminate knowledge from data (what computer scientists do). My passion as a researcher is to integrate insights from these fields in a useful way to promote equitable and sustainable global access to safe water and energy."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Anatoly Tsyplenkov",
    "section": "",
    "text": "I did my Ph.D. at the Lomonosov Moscow State University, where I was interested in the spatio-temporal variability of sediment transport in mountain areas, and a postdoc at the Institute of Geography Russian Academy of Science, where I focused on remote sensing and geomorphology in the Caucasus. While a hydrologist and fluvial geomorphologist at the core, I am fascinated by creative ways to visualize the data (what dataviz designers do), and by transformative technologies to extract and disseminate knowledge from data (what computer scientists do). My passion as a researcher is to integrate insights from these fields in a useful way to promote equitable and sustainable global access to safe water and energy."
  },
  {
    "objectID": "index.html#my-notes",
    "href": "index.html#my-notes",
    "title": "Anatoly Tsyplenkov",
    "section": "My notes",
    "text": "My notes"
  },
  {
    "objectID": "papers.html",
    "href": "papers.html",
    "title": "Papers",
    "section": "",
    "text": "A .pdf version can be downloaded here .\n2022\n\n\nBelyakova, P., Moreydo, V., Tsyplenkov, A., Amerbaev, A., Grechishnikova, D., Kurochkina, L., Filippov, V., Makeev, M. Forecasting Water Levels in Krasnodar Krai Rivers with the Use of Machine Learning. Water Resources (2022) \n\n\nБелякова, П. А., Морейдо, В. М., Цыпленков, А. С., Амербаев, А. Н., Гречишникова, Д. А., Курочкина, Л. С., Филиппов, В. А., Макеев, М. С. Прогнозирование уровней воды на реках Краснодарского края с использованием методов машинного обучения. Водные ресурсы (2022) \n\n\n2021\n\n\nЦыпленков, А. С., Иванова, Н. Н., Ботавин, Д. В., Кузнецова, Ю. С., Голосов, В. Н. Гидрометеорологические предпосылки и геоморфологические последствия экстремального паводка в бассейне малой реки в зоне влажных субтропиков (на примере р. Цанык, район Сочи). Вестник Санкт-Петербургского университета. Науки о Земле (2021) \n\n\nGolosov, V. N., Ivanov, M. M., Tsyplenkov, A. S., Ivanov, M. A., Konoplev, A. V., Wakiyama, Yu, Konstantinov, E. A., Ivanova, N. N. Erosion as a Factor of Transformation of Soil Radioactive Contamination in the Basin of the Shchekino Reservoir (Tula Region). Eurasian Soil Science (2021) \n\n\nГолосов, В. Н., Иванов, М. М., Цыпленков, А. С., Иванов, М. А., Вакияма, Ю., Коноплев, А. В., Константинов, Е. А., Иванова, Н. Н. Эрозия как фактор трансформации радиоактивного загрязнения почв на водосборе Щекинского водохранилища (Тульская область). Почвоведение (2021) \n\n\nGolosov, Valentin, Tsyplenkov, Anatoly Factors Controlling Contemporary Suspended Sediment Yield in the Caucasus Region. Water (2021)  \n\n\nIvanov, M. M., Konoplev, A. V., Walling, D. E., Konstantinov, E. A., Gurinov, A. L., Ivanova, N. N., Kuzmenkova, N. V., Tsyplenkov, A. S., Ivanov, M. A., Golosov, V. N. Using Reservoir Sediment Deposits to Determine the Longer-Term Fate of Chernobyl-Derived 137Cs Fallout in the Fluvial System. Environmental Pollution (2021) \n\n\nKuksina, L. V., Golosov, V.N., Zhdanova, E. Yu., Tsyplenkov, A. S. Hydrological and Climatological Factors of Extreme Erosion Events in the Crimean Mountains. Vestnik Moskovskogo universiteta. Seriya 5, Geografiya (2021) \n\n\nTsyplenkov, Anatoly, Vanmaercke, Matthias, Collins, Adrian L., Kharchenko, Sergey, Golosov, Valentin Elucidating Suspended Sediment Dynamics in a Glacierized Catchment after an Exceptional Erosion Event: The Djankuat Catchment, Caucasus Mountains, Russia. CATENA (2021)  \n\n\nTsyplenkov, A. S., Golosov, V. N., Belyakova, P. A. How Did the Suspended Sediment Load Change in the North Caucasus during the Anthropocene?. Hydrological Processes (2021)   \n\n\nTsyplenkov, Anatoly S., Ivanova, Nadezhda N., Botavin, Dmitry V., Kuznetsova, Yulia S., Golosov, Valentin N. Hydro-Meteorological Preconditions and Geomorphological Consequences of Extreme Flood in the Small River Basin in the Wet Subtropical Zone (the Tsanyk River Case Study, Sochi Region). Vestnik of Saint Petersburg University. Earth Sciences (2021) \n\n\n2020\n\n\nChalov, S. R., Tsyplenkov, A. S. Influence of macroturbulence on the dynamics of river water turbidity. Vestnik Moskovskogo universiteta. Seriya 5, Geografiya (2020) \n\n\nKharchenko, Sergey, Tsyplenkov, Anatoly, Petrakov, Dmitry, Golosov, Valentin Causes and Consequences of the Streambed Restructuring of the Koiavgan Creek (North Caucasus, Russia). E3S Web of Conferences (2020) \n\n\nTsyplenkov, Anatoly, Vanmaercke, Matthias, Golosov, Valentin, Chalov, Sergey Suspended Sediment Budget and Intra-Event Sediment Dynamics of a Small Glaciated Mountainous Catchment in the Northern Caucasus. Journal of Soils and Sediments (2020)  \n\n\n2019\n\n\nKuznetsova, Yulia, Golosov, Valentin, Tsyplenkov, Anatoly, Ivanova, Nadezhda Quantifying Channel Bank Erosion of a Small Mountain River in Russian Wet Subtropics Using Erosion Pins. Proceedings of the International Association of Hydrological Sciences (2019) \n\n\nRets, Ekaterina P., Popovnin, Viktor V., Toropov, Pavel A., Smirnov, Andrew M., Tokarev, Igor V., Chizhova, Julia N., Budantseva, Nadine A., Vasil’chuk, Yurij K., Kireeva, Maria B., Ekaykin, Alexey A., Veres, Arina N., Aleynikov, Alexander A., Frolova, Natalia L., Tsyplenkov, Anatoly S., Poliukhov, Aleksei A., Chalov, Sergey R., Aleshina, Maria A., Kornilova, Ekaterina D. Djankuat Glacier Station in the North Caucasus, Russia: A Database of Glaciological, Hydrological, and Meteorological Observations and Stable Isotope Sampling Results during 2007–2017. Earth System Science Data (2019) \n\n\nTsyplenkov, Anatoly, Vanmaercke, Matthias, Golosov, Valentin Contemporary Suspended Sediment Yield of Caucasus Mountains. Proceedings of the International Association of Hydrological Sciences (2019)  \n\n\n2017\n\n\nChalov, S. R., Tsyplenkov, A. S. Sediment Discharge of Small Rivers in Areas of Active Volcanism (River Sukhaya Elizovskaya, Kamchatka). Geomorphology RAS (2017) \n\n\nChalov, Sergey R., Tsyplenkov, Anatolii S., Pietron, Jan, Chalova, Aleksandra S., Shkolnyi, Danila I., Jarsjö, Jerker, Maerker, Michael Sediment Transport in Headwaters of a Volcanic Catchment—Kamchatka Peninsula Case Study. Frontiers of Earth Science (2017) \n\n\nChalov, S., Golosov, V., Tsyplenkov, A., Theuring, Ph., Zakerinejad, R., Märker, M., Samokhin, M. A Toolbox for Sediment Budget Research in Small Catchments. GEOGRAPHY, ENVIRONMENT, SUSTAINABILITY (2017) \n\n\nTsyplenkov, A. S., Golosov, V. N., Kuksina, L. V. Assessment of Basin Component of Suspended Sediment Yield Generated Due to Rainfall Events at Small Rivers in Wet and Dry Subtropics. Engineering survey (2017)"
  },
  {
    "objectID": "posts/2020-03-03-tidy-tuesday-nhl/2020-03-03-tidy-tuesday-nhl.html",
    "href": "posts/2020-03-03-tidy-tuesday-nhl/2020-03-03-tidy-tuesday-nhl.html",
    "title": "Tidy Tuesday NHL",
    "section": "",
    "text": "Code\nlibrary(tidyverse)\nlibrary(atslib)\nlibrary(extrafont)\nlibrary(hrbrthemes)\ntheme_set(hrbrthemes::theme_ft_rc(base_family = \"Ubuntu Condensed\"))\n\ntop_250 <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-03/top_250.csv')\n\ntop_250\n\n\n# A tibble: 251 × 9\n   raw_rank player        years   total_g…¹ url_n…² raw_l…³ link  active yr_st…⁴\n      <dbl> <chr>         <chr>       <dbl>   <dbl> <chr>   <chr> <chr>    <dbl>\n 1        1 Wayne Gretzky 1979-99       894       1 /playe… http… Retir…    1979\n 2        2 Gordie Howe   1946-80       801       2 /playe… http… Retir…    1946\n 3        3 Jaromir Jagr  1990-18       766       3 /playe… http… Retir…    1990\n 4        4 Brett Hull    1986-06       741       4 /playe… http… Retir…    1986\n 5        5 Marcel Dionne 1971-89       731       5 /playe… http… Retir…    1971\n 6        6 Phil Esposito 1963-81       717       6 /playe… http… Retir…    1963\n 7        7 Mike Gartner  1979-98       708       7 /playe… http… Retir…    1979\n 8        8 Alex Ovechkin 2005-20       700       8 /playe… http… Active    2005\n 9        9 Mark Messier  1979-04       694       9 /playe… http… Retir…    1979\n10       10 Steve Yzerman 1983-06       692      10 /playe… http… Retir…    1983\n# … with 241 more rows, and abbreviated variable names ¹​total_goals,\n#   ²​url_number, ³​raw_link, ⁴​yr_start\n# ℹ Use `print(n = ...)` to see more rows\n\n\nThis dataset contains 250 NHL & WHA career leaders and records for goals. First, we’re going to tidy our dataset a bit. What is the most interesting here is total goals really depends on the career length?\nThe information about years of career contains in years variable. It has a structure of YYYY-YY. First of all, let split it to year_start and year_end.\n\n\nCode\ntidy_250 <- top_250 %>% \n  mutate(year_start = str_split(years, \"-\", simplify = T)[,1],\n         year_end = str_split(years, \"-\", simplify = T)[,2]) %>% \n  mutate_at(vars(year_start), ~as.numeric(.)) %>% \n  mutate(century = ifelse(year_start < 2000, 19, 20),\n         cc = str_split(year_start, \n                        as.character(century),\n                        simplify = T)[,2],\n         cc = as.numeric(cc)) %>%\n  mutate(year_end = case_when(\n    year_end > cc ~ paste0(19, year_end),\n    TRUE ~ paste0(20, year_end)\n  )) %>% \n  mutate_at(vars(year_start, year_end), ~as.numeric(.)) %>% \n  # We need to edit millenials ))\n  mutate(year_end = ifelse(year_end < year_start,\n                           year_end + 100,\n                           year_end)) %>% \n  select(player, total_goals, year_start, year_end) \n\ntidy_250\n\n\n# A tibble: 251 × 4\n   player        total_goals year_start year_end\n   <chr>               <dbl>      <dbl>    <dbl>\n 1 Wayne Gretzky         894       1979     1999\n 2 Gordie Howe           801       1946     1980\n 3 Jaromir Jagr          766       1990     2018\n 4 Brett Hull            741       1986     2006\n 5 Marcel Dionne         731       1971     1989\n 6 Phil Esposito         717       1963     1981\n 7 Mike Gartner          708       1979     1998\n 8 Alex Ovechkin         700       2005     2020\n 9 Mark Messier          694       1979     2004\n10 Steve Yzerman         692       1983     2006\n# … with 241 more rows\n# ℹ Use `print(n = ...)` to see more rows\n\n\nGreat! Now we have a very tidy dataframe. However, if we are going to plot career length of all 250 players, it can be a total mess on the plot. Let’s select only first 50 players using dplyr::top_().\n\n\nCode\ntidy_50 <- tidy_250 %>% \n  top_n(50, total_goals)\n\n\nI prefer to use discrete color scale instead of continuous. So I’m going to convert total_goals into factor. I really like to do it interactively with a new questionr package! So easy!\n\n\nCode\n## Cutting tidy_50$total_goals into tidy_50$total_goals_rec\ntidy_50$total_goals_rec <- cut(tidy_50$total_goals,\n                               include.lowest=TRUE,  right=TRUE,\n                               breaks = c(400, 500, 600, 700, 800, 900),\n                               labels = c(\"400-500\",\n                                          \"500-600\",\n                                          \"600-700\",\n                                          \"700-800\",\n                                          \"800-900\"))\n\n\nOkay, so everything is ready for a plot! Please, notice, that I’ve already set the ggplot theme in the first r chunk via theme_set. I prefer to use dark themes everywhere so for this post I’ll also use a dark one. Bob Rudis (hrbrmstr) has created a really nice one in his hrbrthemes.\n\n\nCode\nlibrary(ggalt)\nlibrary(paletteer)\n\ntidy_50 %>% \n  mutate(len = year_end - year_start) %>% \n  mutate(player = fct_reorder(player, year_start)) %>%\n  ggplot(aes(x = year_start,\n             xend = year_end,\n             y = player,\n             group = player)) + \n  ggalt::geom_dumbbell(aes(color = total_goals_rec),\n                size_x = 1.3,\n                size_xend = 1.3,\n                size = 1) +\n  labs(x = \"Years active\", y = \"\",\n       title = \"NHL Career Leaders and Records for Goals\",\n       subtitle = \"TOP 50\",\n       caption = \"Made by @atsyplen as a #TidyTuesday contribution\") +\n  paletteer::scale_color_paletteer_d(name = \"Total goals:\",\n                                     \"wesanderson::Zissou1\") +\n  theme(panel.grid.major.y = element_blank())\n\n\n\n\n\nLet’s create a bit more meaningful plot. It’s very interesting how total_goals are spread inside career lengths groups! For this one I’d prefer a boxlplot.\n\n\nCode\ntidy_250 %>% \n  mutate(len = year_end - year_start) %>% \n  mutate(len = cut(len,\n                   include.lowest=TRUE,  right=TRUE,\n                   breaks = c(5, 10, 15, 20, 25, 30, 35, 40),\n                   labels = c(\n                     \"5-10\",\n                     \"10-15\",\n                     \"15-20\",\n                     \"20-25\",\n                     \"25-30\",\n                     \"30-35\",\n                     \"35-40\"\n                   ))) %>% \n  group_by(len) %>% \n  mutate(outlier.high = total_goals > quantile(total_goals, .75, na.rm = T) + 1.50*IQR(total_goals, na.rm = T),\n         outlier.low = total_goals < quantile(total_goals, .25, na.rm = T) - 1.50*IQR(total_goals, na.rm = T),\n         outlier.color = case_when(outlier.high ~ \"red\",\n                                   outlier.low ~ \"steelblue\",\n                                   outlier.low == F | outlier.high == F ~ \"black\")) %>%\n  ggplot(aes(x = len, y = total_goals)) +\n  stat_boxplot(geom ='errorbar',\n               width = .25,\n               color = \"white\") +\n  geom_boxplot(outlier.shape = NA,\n               color = \"white\",\n               fill = \"white\",\n               alpha = .3) +\n  geom_jitter(aes(color = outlier.color),\n              width = .1,\n              alpha = .6,\n              show.legend = F) +\n  scale_y_continuous(breaks = seq(100, 900, 100),\n                     labels = seq(100, 900, 100)) +\n  ggrepel::geom_text_repel(data = . %>% group_by(len) %>% \n                             filter(total_goals == max(total_goals)),\n                           aes(label = player), segment.colour = \"white\",\n                           color = \"white\", family = \"Ubuntu Condensed\") +\n  ggsci::scale_color_lancet() +\n  labs(y = \"Total goals scored in career\",\n       x = \"Career length, years\",\n       title = \"NHL Career Leaders and Records for Goals\",\n       subtitle = \"TOP 250\",\n       caption = \"Made by @atsyplen as a #TidyTuesday contribution\") +\n  theme(panel.grid.major.x = element_blank())"
  },
  {
    "objectID": "posts/2022-03-05-soilgrids-terra/2022-03-05-soilgrids-terra.html",
    "href": "posts/2022-03-05-soilgrids-terra/2022-03-05-soilgrids-terra.html",
    "title": "Accessing SoilGrids via {terra}",
    "section": "",
    "text": "ERROR 11: CURL error: SSL certificate problem: unable to get local issuer certificate\n\nI never managed to fix this issue, so I decided to let it go since everyone is slowly quitting GDAL anyway. Here is my approach to downloading cropped and reprojected SoilGrids raster. There was a really great tutorial by Ivan Lizarazo on getting several SoilGrids layers using rgdal. My approach is mostly based on it.\n\n1. Boundary layer\nFirst of all, let’s load some boundary layer, i.e., our area of interest (AOI). I will use the default sf sample data for North Carolina counties. To reduce the size of AOI, let me select only the first county. The SoilGrids files are stored in Interrupted Goode Homolosine, so I have to reproject our AOI polygon to it.\n\n\nCode\nlibrary(dplyr)\nlibrary(sf)\n\n# Load sample data\nnc <- st_read(system.file(\"shape/nc.shp\",\n  package = \"sf\"\n),\nquiet = T\n) %>%\n  slice(1)\n\n# Transform to IGH projection\nigh <- \"+proj=igh +lat_0=0 +lon_0=0 +datum=WGS84 +units=m +no_defs\"\nnc_igh <- st_transform(nc, igh)\n\n\n\n\n2. Download urls\nNow Let’s just copy download urls from previous tutorials. And create a link to every other separate .vrt file, since we are gonna purrr::map them later. I’m interested only in mean topsoil characteristics (i.e. 0-30 cm) right now. So I will download sand, silt, and clay content and soil organic carbon content (soc).\n\n\nCode\nsg_url <- \"/vsicurl/https://files.isric.org/soilgrids/latest/data/\"\nprops <- c(\"sand\", \"silt\", \"clay\", \"soc\")\nlayers <- c(\"0-5\", \"5-15\", \"15-30\")\n\nvrt <- paste0(\n  props, \"/\",\n  props, \"_\",\n  rep(layers, 4),\n  \"cm_mean.vrt\"\n)\n\nvrt[1]\n\n\n[1] \"sand/sand_0-5cm_mean.vrt\"\n\n\nThen, we need to create a list of paths to save. Let’s create a directory soilgrid where we are going to download our layers.\n\n\nCode\n# Optional\n# Check if the directory exists\nif (!dir.exists(\"soilgrid\")) {\n  dir.create(\"soilgrid\")\n}\n\n\n# Create paths\nlfile <- paste0(\n  \"soilgrid/\",\n  props, \"_\",\n  rep(layers, 4),\n  \".tif\"\n)\n\nlfile[1]\n\n\n[1] \"soilgrid/sand_0-5.tif\"\n\n\n\n\n3. Download and preprocess function\nMy general idea is to crop the SoilGrid layer to the bounding box, reproject to my CRS (i.e. CRS of the nc layer), download, and then write as .tif. However, I want to do this for 12 rasters. Therefore, we need to write a function we are going to apply:\n\n\nCode\nlibrary(terra)\n\n# Function to download and transform soilgrid layers\nsoilgrids_download <- function(list_vrt, # download url\n                               list_lfile, # destination path\n                               shape_igh, # AOI shape in IGH proj\n                               destproj) { # desired projection\n\n  terra::rast(paste0(sg_url, list_vrt)) %>% # read raster\n    terra::crop(ext(vect(shape_igh))) %>% # crop to bounding box\n    terra::project(destproj) %>% # reproject\n    terra::writeRaster(list_lfile,\n      overwrite = T\n    ) # Save\n}\n\n\nBefore running it in the loop, let’s try it for the first layer.\n\n\nCode\nsoilgrids_download(\n  list_vrt = vrt[1],\n  list_lfile = lfile[1],\n  shape_igh = nc_igh,\n  destproj = st_crs(nc)$proj4string\n)\n\nrast(lfile[1]) %>%\n  plot()\n\n\n\n\n\nIt worked!\n\n\n4. Map download\nNext, with the help of purrr we can apply this function to all our links. Let’s measure elapsed time.\n\n\nCode\nlibrary(purrr)\nlibrary(tictoc)\n\ntic()\nwalk2(\n  vrt,\n  lfile,\n  ~ soilgrids_download(.x, .y,\n    shape_igh = nc_igh,\n    destproj = st_crs(nc)$proj4string\n  )\n)\ntoc()\n\n\n79.04 sec elapsed\n\n\nWell, almost 2 mins. It is necessary to improve the timing somehow. This process can be run in parallel with furrr.\n\n\nCode\nlibrary(furrr)\n\n# Set Parallel\nno_cores <- availableCores() - 1\nplan(multisession,\n  workers = no_cores\n)\n\n# Download!\ntic()\nfuture_walk2(\n  vrt, lfile,\n  ~ soilgrids_download(.x, .y,\n    shape_igh = nc_igh,\n    destproj = st_crs(nc)$proj4string\n  )\n)\ntoc()\n\n\n42.04 sec elapsed\n\n\nCode\n# Exit parallel\nplan(sequential)\n\n\nLess than 1 minute. As Josh Starmer says, “BAM!”. Three times faster!\n\n\nCode\nlist.files(\"soilgrid\")\n\n\n [1] \"clay_0-5.tif\"   \"clay_15-30.tif\" \"clay_5-15.tif\"  \"sand_0-5.tif\"  \n [5] \"sand_15-30.tif\" \"sand_5-15.tif\"  \"silt_0-5.tif\"   \"silt_15-30.tif\"\n [9] \"silt_5-15.tif\"  \"soc_0-5.tif\"    \"soc_15-30.tif\"  \"soc_5-15.tif\""
  },
  {
    "objectID": "software.html",
    "href": "software.html",
    "title": "Software",
    "section": "",
    "text": "The goal of HBVr is to ease the accessebility of HBV Global Parameter maps created by Beck et al. (2020). Therefore this one-function package allows to download any of the cross-validation folds for your particular area of interest (AOI).\n\n        \n        Website\n     \n        \n        Github\n    \nrusleR\n This package offers an R implementation of the Universal Soil Loss Equation (USLE). You can find here a collection of functions to estimate main factors: R-factor, K-factor, LS-factor and C-factor. The package uses terra and Rsagacmd in the backend.\n\n        \n        Website\n     \n        \n        Github\n    \nloadflux\n The loadflux package is build for the comprehensive analysis of the intra-event suspended sediment dynamics. This is a collection of functions created to study water discharge (Q) and suspended sediment concentration (SSC) relationship.\n\n        \n        Website\n     \n        \n        Github\n     \n        \n        Package\n    \ntgme\n This is a very simple package with only one function tgme. The aim of this package is to send you a message when a job on Rstudio server is done (or on your local machine).\nIt is a free alternative to the Rich Pauloo’s textme package.\n\n        \n        Github"
  }
]